<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø³ØªØ¹Ø±Ø¶ Ø§ÙØªØªØ§Ø­ÙŠØ§Øª Lichess Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</title>
    <style>
        :root {
            --bg-color: #161512; /* Ø£Ù„ÙˆØ§Ù† Lichess Ø§Ù„Ø¯Ø§ÙƒÙ†Ø© */
            --card-bg: #262421;
            --primary-color: #629924;
            --accent-color: #bababa;
            --text-color: #ffffff;
        }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 20px; }
        .container { max-width: 1000px; margin: auto; }
        
        .header-box { text-align: center; margin-bottom: 30px; }
        .controls { background: var(--card-bg); padding: 20px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); position: sticky; top: 10px; z-index: 100; }
        
        .search-group { display: flex; gap: 10px; flex-wrap: wrap; }
        input { flex: 1; padding: 12px; border-radius: 4px; border: 1px solid #403d39; background: #1a1917; color: white; font-size: 16px; }
        
        button { padding: 10px 20px; border-radius: 4px; border: none; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-mode { background-color: #363432; color: white; border: 1px solid #403d39; }
        .btn-mode.active { background-color: var(--primary-color); border-color: var(--primary-color); }
        
        /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
        .openings-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; margin-top: 20px; }
        .card { background: var(--card-bg); padding: 15px; border-radius: 5px; border-bottom: 3px solid transparent; transition: 0.3s; }
        .card:hover { border-bottom: 3px solid var(--primary-color); background: #2d2b28; }
        .card h3 { margin: 0 0 10px 0; font-size: 1rem; color: #fff; }
        .card .move-text { display: block; background: #1a1917; padding: 8px; border-radius: 4px; font-family: 'Courier New', Courier, monospace; color: #99c766; margin-top: 10px; font-size: 0.9rem; }
        .card .eco { font-size: 0.75rem; color: #999; text-transform: uppercase; border: 1px solid #444; padding: 2px 5px; border-radius: 3px; }

        .loading-text { text-align: center; color: var(--primary-color); padding: 20px; font-weight: bold; }
        .load-more-container { text-align: center; margin-top: 30px; }
        .btn-load { background: var(--primary-color); color: white; padding: 12px 50px; border-radius: 4px; display: none; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <div class="header-box">
        <h1>ğŸ” Ù…Ø³ØªØ¹Ø±Ø¶ Ø§ÙØªØªØ§Ø­ÙŠØ§Øª Lichess</h1>
        <p id="loadingStatus" class="loading-text">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© (3000+ Ø§ÙØªØªØ§Ø­)...</p>
    </div>

    <div class="controls">
        <div class="search-group">
            <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¨Ø­Ø«..." oninput="handleSearch()">
            <button id="modeBtn" class="btn-mode" onclick="toggleMode()">ÙˆØ¶Ø¹ Ø§Ù„Ø¨Ø­Ø«: Ø§Ù„Ø§Ø³Ù…</button>
        </div>
    </div>

    <div id="openingsGrid" class="openings-grid"></div>

    <div class="load-more-container">
        <button id="loadMoreBtn" class="btn-load" onclick="loadMore()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯</button>
    </div>
</div>

<script>
    let allOpenings = [];
    let filteredList = [];
    let currentMode = 'name'; 
    let visibleCount = 20;

    // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…Ø³ØªÙˆØ¯Ø¹ Lichess Ø§Ù„Ø±Ø³Ù…ÙŠ Ø¹Ù„Ù‰ GitHub

// Ø§Ø³ØªØ¨Ø¯Ù„ Ø¯Ø§Ù„Ø© fetchOpenings Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ù…Ø·ÙˆØ±
async function fetchOpenings() {
    const loadingStatus = document.getElementById('loadingStatus');
    
    // Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ³ÙŠØ· AllOrigins Ù„ØªØ¬Ø§ÙˆØ² Ù‚ÙŠÙˆØ¯ CORS
    const targetUrl = 'https://raw.githubusercontent.com/lichess-org/chess-openings/master/dist/openings.json';
    const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(targetUrl)}`;
    
    try {
        const response = await fetch(proxyUrl);
        if (!response.ok) throw new Error('Network error');
        
        const dataWrapper = await response.json();
        // Ø§Ù„ÙˆØ³ÙŠØ· ÙŠØ¹ÙŠØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø§Ø®Ù„ Ø­Ù‚Ù„ Ø§Ø³Ù…Ù‡ contents ÙƒÙ€ stringØŒ Ù„Ø°Ø§ Ù†Ø­ØªØ§Ø¬ Ù„ØªØ­ÙˆÙŠÙ„Ù‡ Ù„Ù€ JSON
        const data = JSON.parse(dataWrapper.contents);
        
        allOpenings = data.map(item => ({
            name: item.name,
            eco: item.eco,
            moves: item.pgn
        })).sort((a, b) => a.name.localeCompare(b.name));

        loadingStatus.innerText = `ØªÙ… ØªØ­Ù…ÙŠÙ„ ${allOpenings.length} Ø§ÙØªØªØ§Ø­ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!`;
        setTimeout(() => loadingStatus.classList.add('hidden'), 2000);
        
        filteredList = [...allOpenings];
        renderOpenings();
    } catch (error) {
        console.error("Error details:", error);
        loadingStatus.innerHTML = "<span style='color:red;'>ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ³ÙŠØ·. Ø¬Ø±Ø¨ Ø§Ù„Ø­Ù„ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¨Ø§Ù„Ø£Ø³ÙÙ„.</span>";
    }
}
  
    function toggleMode() {
        const btn = document.getElementById('modeBtn');
        const input = document.getElementById('searchInput');
        
        if (currentMode === 'name') {
            currentMode = 'moves';
            btn.innerText = "ÙˆØ¶Ø¹ Ø§Ù„Ø¨Ø­Ø«: Ø§Ù„Ù†Ù‚Ù„Ø©";
            btn.classList.add('active');
            input.placeholder = "Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ù†Ù‚Ù„Ø© (Ù…Ø«Ù„: 1. e4 c5)";
        } else {
            currentMode = 'name';
            btn.innerText = "ÙˆØ¶Ø¹ Ø§Ù„Ø¨Ø­Ø«: Ø§Ù„Ø§Ø³Ù…";
            btn.classList.remove('active');
            input.placeholder = "Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… (Ù…Ø«Ù„: Sicilian)";
        }
        handleSearch();
    }

    function handleSearch() {
        const query = document.getElementById('searchInput').value.toLowerCase().trim();
        
        filteredList = allOpenings.filter(op => {
            if (currentMode === 'name') {
                // Ø§Ù„Ø¨Ø­Ø« ÙŠØ¨Ø¯Ø£ Ø¨Ù†ÙØ³ Ø§Ù„Ø­Ø±ÙˆÙ (Prefix Search)
                return op.name.toLowerCase().startsWith(query);
            } else {
                // Ø§Ù„Ø¨Ø­Ø« ÙŠØ¨Ø¯Ø£ Ø¨Ù†ÙØ³ Ø§Ù„Ù†Ù‚Ù„Ø§Øª
                return op.moves.toLowerCase().startsWith(query);
            }
        });

        visibleCount = 20;
        renderOpenings();
    }

    function renderOpenings() {
        const grid = document.getElementById('openingsGrid');
        const loadMoreBtn = document.getElementById('loadMoreBtn');
        grid.innerHTML = "";

        const itemsToShow = filteredList.slice(0, visibleCount);

        itemsToShow.forEach(op => {
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <span class="eco">${op.eco}</span>
                <h3>${op.name}</h3>
                <span class="move-text">${op.moves}</span>
            `;
            grid.appendChild(card);
        });

        if (filteredList.length > visibleCount) {
            loadMoreBtn.style.display = "inline-block";
        } else {
            loadMoreBtn.style.display = "none";
        }
    }

    function loadMore() {
        visibleCount += 20;
        renderOpenings();
    }

    // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¹Ù†Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    fetchOpenings();
</script>

</body>
</html>
